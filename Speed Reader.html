<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speed Reader Pro</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Roboto+Mono:wght@500;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #00BCD4, #4DD0E1); /* Cyan Theme */
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        #app-container {
            width: 100%;
            max-width: 900px;
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            padding: 30px;
            min-height: 600px;
            display: flex;
            flex-direction: column;
        }

        /* The Reading Stage */
        #reader-stage {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: #f8fafc;
            border: 4px solid #e2e8f0;
            border-radius: 16px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
            min-height: 300px;
        }

        /* The actual words */
        #word-display {
            font-family: 'Roboto Mono', monospace;
            color: #1e293b;
            text-align: center;
            line-height: 1.4;
            padding: 20px;
            z-index: 10;
        }

        /* Focus Guides (Red lines) */
        .focus-guide {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 4px;
            background-color: #cbd5e1;
            border-radius: 2px;
        }
        .guide-top { top: 20px; }
        .guide-bottom { bottom: 20px; }

        /* Progress Bar */
        #progress-container {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: #e2e8f0;
        }
        #progress-bar {
            height: 100%;
            background: #00BCD4;
            width: 0%;
            transition: width 0.2s linear;
        }

        /* UI Controls */
        .control-panel {
            background: white;
            border-top: 1px solid #f1f5f9;
            padding-top: 20px;
        }

        textarea {
            @apply w-full p-4 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-cyan-500 focus:ring-2 focus:ring-cyan-100 transition resize-y text-gray-700;
            min-height: 200px;
        }

        button {
            @apply transition transform active:scale-95 font-bold rounded-xl px-6 py-3 shadow-lg;
        }
        
        .btn-primary { @apply bg-cyan-500 text-white hover:bg-cyan-600; }
        .btn-danger { @apply bg-red-500 text-white hover:bg-red-600; }
        .btn-secondary { @apply bg-slate-200 text-slate-700 hover:bg-slate-300; }

        /* Range Slider Styling */
        input[type=range] {
            @apply w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer;
        }
        input[type=range]::-webkit-slider-thumb {
            @apply appearance-none w-6 h-6 bg-cyan-500 rounded-full shadow border-2 border-white;
        }
    </style>
</head>
<body>

    <div id="app-container">
        
        <div class="flex justify-between items-center mb-6">
            <button id="global-back-btn" class="text-slate-400 hover:text-cyan-600 font-bold transition flex items-center gap-2">
                <span>‚Üê</span> <span id="back-label">Back to Tools</span>
            </button>
            <h1 class="text-2xl font-black text-slate-800 uppercase tracking-wide">Speed Reader</h1>
            <div class="w-20"></div> </div>

        <div id="input-view" class="flex-grow flex flex-col">
            <h2 class="text-lg font-bold text-slate-600 mb-2">1. Paste your text</h2>
            <textarea id="text-input" placeholder="Paste article, book chapter, or study notes here..."></textarea>
            
            <div class="flex justify-between items-center mt-2 mb-6">
                <span id="word-count" class="text-sm font-bold text-slate-400">0 Words</span>
                <button onclick="document.getElementById('text-input').value=''; updateCount();" class="text-red-400 text-sm font-bold hover:text-red-600">Clear Text</button>
            </div>

            <button onclick="startReader()" class="btn-primary w-full text-xl py-4 mt-auto">
                Start Reading üöÄ
            </button>
        </div>

        <div id="reader-view" class="hidden flex-col h-full">
            
            <div id="reader-stage">
                <div class="focus-guide guide-top"></div>
                <div id="word-display" class="text-5xl">Ready?</div>
                <div class="focus-guide guide-bottom"></div>
                
                <div id="progress-container">
                    <div id="progress-bar"></div>
                </div>
            </div>

            <div class="control-panel grid grid-cols-1 md:grid-cols-3 gap-6 items-center">
                
                <div class="flex justify-center md:justify-start gap-3 order-2 md:order-1">
                    <button id="toggle-btn" class="btn-primary w-24">Play</button>
                    <button onclick="stopReader()" class="btn-secondary">Edit</button>
                </div>

                <div class="flex flex-col items-center order-1 md:order-2">
                    <label class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-2">
                        Speed: <span id="wpm-display" class="text-cyan-600">300</span> WPM
                    </label>
                    <input type="range" id="speed-slider" min="60" max="1000" step="10" value="300">
                </div>

                <div class="flex justify-center md:justify-end gap-4 order-3 text-sm">
                    <div class="flex flex-col">
                        <label class="text-xs font-bold text-slate-400">Chunk Size</label>
                        <select id="chunk-size" class="bg-slate-100 border border-slate-300 rounded p-1 font-bold">
                            <option value="1">1 Word</option>
                            <option value="2">2 Words</option>
                            <option value="3" selected>3 Words</option>
                            <option value="4">4 Words</option>
                        </select>
                    </div>
                    <div class="flex flex-col">
                        <label class="text-xs font-bold text-slate-400">Text Size</label>
                        <select id="font-size" class="bg-slate-100 border border-slate-300 rounded p-1 font-bold">
                            <option value="text-3xl">Small</option>
                            <option value="text-5xl" selected>Medium</option>
                            <option value="text-7xl">Large</option>
                            <option value="text-9xl">Huge</option>
                        </select>
                    </div>
                </div>

            </div>
        </div>

    </div>

    <script>
        // --- VARIABLES ---
        let words = [];
        let currentIndex = 0;
        let isPlaying = false;
        let timer = null;
        
        // Settings
        let wpm = 300; 
        let chunkSize = 3; 
        
        // --- ELEMENTS ---
        const inputView = document.getElementById('input-view');
        const readerView = document.getElementById('reader-view');
        const textInput = document.getElementById('text-input');
        const wordDisplay = document.getElementById('word-display');
        const progressBar = document.getElementById('progress-bar');
        const toggleBtn = document.getElementById('toggle-btn');
        const speedSlider = document.getElementById('speed-slider');
        const wpmDisplay = document.getElementById('wpm-display');
        const chunkSelect = document.getElementById('chunk-size');
        const fontSelect = document.getElementById('font-size');
        const globalBackBtn = document.getElementById('global-back-btn');
        const backLabel = document.getElementById('back-label');

        // --- SETUP ---
        
        // 1. Text Input Listener
        textInput.addEventListener('input', updateCount);
        
        function updateCount() {
            const txt = textInput.value.trim();
            const count = txt ? txt.split(/\s+/).length : 0;
            document.getElementById('word-count').innerText = count + " Words";
        }

        // 2. Navigation Logic (The "Smart" Back Button)
        globalBackBtn.addEventListener('click', () => {
            // Check if Reader is currently visible
            if (!readerView.classList.contains('hidden')) {
                // If reading, go back to Input
                stopReader();
            } else {
                // If on input screen, go back to Index
                window.location.href = 'index.html';
            }
        });

        // 3. Start Logic
        function startReader() {
            const rawText = textInput.value.trim();
            if(!rawText) return alert("Please enter some text!");

            words = rawText.split(/\s+/);
            currentIndex = 0;
            
            // Switch Views
            inputView.classList.add('hidden');
            readerView.classList.remove('hidden');
            readerView.classList.add('flex');
            
            // Change Back Button Label
            backLabel.innerText = "Back to Input";

            // Reset state
            updateDisplay("Ready?");
            progressBar.style.width = "0%";
            isPlaying = false;
            toggleBtn.textContent = "Start";
            toggleBtn.classList.remove('bg-amber-500');
            toggleBtn.classList.add('bg-cyan-500');
        }

        // 4. Stop Logic (Back to input)
        function stopReader() {
            clearTimeout(timer);
            
            // Switch Views
            readerView.classList.add('hidden');
            readerView.classList.remove('flex');
            inputView.classList.remove('hidden');

            // Reset Back Button Label
            backLabel.innerText = "Back to Tools";
        }

        // 5. The Loop (Tick)
        function tick() {
            if(currentIndex >= words.length) {
                isPlaying = false;
                toggleBtn.textContent = "Restart";
                return;
            }

            const chunk = words.slice(currentIndex, currentIndex + chunkSize).join(" ");
            
            updateDisplay(chunk);
            
            const pct = Math.min(100, (currentIndex / words.length) * 100);
            progressBar.style.width = pct + "%";

            currentIndex += chunkSize;

            const msPerWord = 60000 / wpm; 
            const delay = msPerWord * chunkSize;

            if(isPlaying) {
                timer = setTimeout(tick, delay);
            }
        }

        // 6. Toggle Play/Pause
        toggleBtn.addEventListener('click', () => {
            if(currentIndex >= words.length) {
                currentIndex = 0; 
            }

            isPlaying = !isPlaying;
            
            if(isPlaying) {
                toggleBtn.textContent = "Pause";
                toggleBtn.classList.remove('bg-cyan-500');
                toggleBtn.classList.add('bg-amber-500');
                tick();
            } else {
                toggleBtn.textContent = "Resume";
                toggleBtn.classList.remove('bg-amber-500');
                toggleBtn.classList.add('bg-cyan-500');
                clearTimeout(timer);
            }
        });

        // 7. Settings Listeners
        speedSlider.addEventListener('input', (e) => {
            wpm = parseInt(e.target.value);
            wpmDisplay.innerText = wpm;
        });

        chunkSelect.addEventListener('change', (e) => {
            chunkSize = parseInt(e.target.value);
        });

        fontSelect.addEventListener('change', (e) => {
            wordDisplay.classList.remove('text-3xl', 'text-5xl', 'text-7xl', 'text-9xl');
            wordDisplay.classList.add(e.target.value);
        });

        function updateDisplay(text) {
            wordDisplay.innerText = text;
        }

    </script>
</body>
</html>